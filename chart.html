<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>堅果比例圓餅圖</title>
  <!-- 引入Tailwind CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
    rel="stylesheet"
  />
  <!-- 引入Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- 引入Chart.js數據標籤插件 -->
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
  <style>
    /* 使用莫蘭迪色系 */
    body {
      background-color: #edeae0;
      color: #4d4d4d;
    }

    .chart-container {
      max-width: 500px;
      margin: 0 auto;
    }

    .chart-title {
      text-align: center;
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 10px;
    }

     /* 固定canvas大小 */
     canvas {
      min-width: 250px !important;
    }
  </style>
</head>
<body class="p-6">
  <div class="container mx-auto">
    <h1 class="text-3xl font-bold text-center mb-6">堅果比例圓餅圖</h1>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <!-- 活腦組合 -->
      <div class="chart-container">
        <div class="chart-title">活腦組合</div>
        <canvas id="brainBoosterChart"></canvas>
      </div>

      <!-- 美肌組合 -->
      <div class="chart-container">
        <div class="chart-title">美肌組合</div>
        <canvas id="beautySkinChart"></canvas>
      </div>

      <!-- 健身組合 -->
      <div class="chart-container">
        <div class="chart-title">健身組合</div>
        <canvas id="fitnessChart"></canvas>
      </div>

      <!-- 楓糖肉桂 -->
      <div class="chart-container">
        <div class="chart-title">楓糖肉桂</div>
        <canvas id="mapleCinnamonChart"></canvas>
      </div>

      <!-- 辣味巧克力 -->
      <div class="chart-container">
        <div class="chart-title">辣味巧克力</div>
        <canvas id="spicyChocolateChart"></canvas>
      </div>

      <!-- 椰蓉咖哩 -->
      <div class="chart-container">
        <div class="chart-title">椰蓉咖哩</div>
        <canvas id="coconutCurryChart"></canvas>
      </div>

      <!-- 海鹽迷迭香 -->
      <div class="chart-container">
        <div class="chart-title">海鹽迷迭香</div>
        <canvas id="seaSaltRosemaryChart"></canvas>
      </div>
    </div>
  </div>

  <script>
    // 更新的堅果組合資料
    const nutsData = {
      活腦組合: {
        核桃: 35,
        杏仁果: 25,
        南瓜籽: 20,
        巴西豆: 10,
        胡桃: 10,
        夏威夷豆: 0,
      },
      美肌組合: {
        杏仁果: 35,
        南瓜籽: 25,
        榛果: 20,
        夏威夷豆: 10,
        胡桃: 10,
        巴西豆: 0,
      },
      健身組合: {
        腰果: 30,
        杏仁果: 25,
        南瓜籽: 20,
        核桃: 15,
        巴西豆: 10,
        胡桃: 0,
        夏威夷豆: 0,
      },
      楓糖肉桂: {
        杏仁果: 20,
        核桃: 35,
        夏威夷豆: 0,
        腰果: 30,
        榛果: 15,
        胡桃: 0,
        巴西豆: 0,
        南瓜籽: 0,
      },
      辣味巧克力: {
        杏仁果: 20,
        核桃: 35,
        夏威夷豆: 0,
        腰果: 30,
        榛果: 15,
        胡桃: 0,
        巴西豆: 0,
        南瓜籽: 0,
      },
      椰蓉咖哩: {
        杏仁果: 20,
        核桃: 35,
        夏威夷豆: 0,
        腰果: 30,
        榛果: 0,
        胡桃: 15,
        巴西豆: 0,
        南瓜籽: 0,
      },
      海鹽迷迭香: {
        杏仁果: 30,
        核桃: 30,
        夏威夷豆: 0,
        腰果: 25,
        榛果: 15,
        胡桃: 0,
        巴西豆: 0,
        南瓜籽: 0,
      },
    };

    // 根據莫蘭迪色系進行配色
    const nutColors = {
      核桃: '#8E735B', // 深灰褐色
      杏仁果: '#D3B8AE', // 柔和杏色
      南瓜籽: '#78866B', // 莫蘭迪綠
      巴西豆: '#E4D6C1', // 米色
      胡桃: '#A47463', // 暗紅褐色
      夏威夷豆: '#EDE3D2', // 淡米色
      榛果: '#7F5A58', // 深褐色
      腰果: '#DCC8A4', // 暖米色
    };

    // 過濾掉數值為 0 的項目，並返回對應的顏色
    function filterZeroData(data) {
      const labels = [];
      const values = [];
      const colors = [];
      Object.keys(data).forEach(key => {
        if (data[key] > 0) {
          labels.push(key);
          values.push(data[key]);
          colors.push(nutColors[key]);
        }
      });
      return { labels, values, colors };
    }

    // 初始化圖表
    function createChart(ctx, data) {
      const filteredData = filterZeroData(data);
      return new Chart(ctx, {
        type: 'pie',
        data: {
          labels: filteredData.labels,
          datasets: [{
            data: filteredData.values,
            backgroundColor: filteredData.colors,
          }],
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'bottom',
            },
            datalabels: {
              color: '#4d4d4d',
              font: {
                weight: 'bold',
                size: 14,
              },
              formatter: (value) => `${value}%`,
            },
          },
        },
        plugins: [ChartDataLabels],
      });
    }

    // 創建各組合的圖表
    createChart(document.getElementById('brainBoosterChart').getContext('2d'), nutsData['活腦組合']);
    createChart(document.getElementById('beautySkinChart').getContext('2d'), nutsData['美肌組合']);
    createChart(document.getElementById('fitnessChart').getContext('2d'), nutsData['健身組合']);
    createChart(document.getElementById('mapleCinnamonChart').getContext('2d'), nutsData['楓糖肉桂']);
    createChart(document.getElementById('spicyChocolateChart').getContext('2d'), nutsData['辣味巧克力']);
    createChart(document.getElementById('coconutCurryChart').getContext('2d'), nutsData['椰蓉咖哩']);
    createChart(document.getElementById('seaSaltRosemaryChart').getContext('2d'), nutsData['海鹽迷迭香']);
  </script>
</body>
</html>
